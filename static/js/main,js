document.addEventListener('DOMContentLoaded', function () {
    // Geolocalização para formulários que a possuem
    const latInput = document.getElementById('latitude');
    const lonInput = document.getElementById('longitude');
    const getLocationBtn = document.getElementById('getLocationBtn');
    const locationStatus = document.getElementById('locationStatus');

    if (getLocationBtn && latInput && lonInput && locationStatus) {
        getLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                locationStatus.textContent = 'Obtendo localização...';
                locationStatus.style.color = '#5bc0de'; // Info color

                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        latInput.value = position.coords.latitude.toFixed(6);
                        lonInput.value = position.coords.longitude.toFixed(6);
                        locationStatus.textContent = 'Localização obtida com sucesso!';
                        locationStatus.style.color = 'green';
                    },
                    (error) => {
                        let errorMsg = 'Erro ao obter localização: ';
                        switch (error.code) {
                            case error.PERMISSION_DENIED:
                                errorMsg += "Permissão de localização negada pelo usuário.";
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMsg += "Informação de localização indisponível.";
                                break;
                            case error.TIMEOUT:
                                errorMsg += "Tempo esgotado ao tentar obter localização.";
                                break;
                            case error.UNKNOWN_ERROR:
                                errorMsg += "Ocorreu um erro desconhecido.";
                                break;
                        }
                        locationStatus.textContent = errorMsg;
                        locationStatus.style.color = 'red';
                    },
                    {
                        enableHighAccuracy: true, // Tenta obter localização mais precisa
                        timeout: 10000,           // Timeout de 10 segundos
                        maximumAge: 0             // Não usar cache de localização
                    }
                );
            } else {
                locationStatus.textContent = "Geolocalização não é suportada por este navegador.";
                locationStatus.style.color = 'orange';
            }
        });
    }

    // Outros scripts globais podem ir aqui
    // Ex: Ativar/desativar links de navegação com base na classe 'active'
    // ou manipulação de formulários comuns.
});